<!-- hn-clear.html ‚Äì v8 -->
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Hacker News -- Simple</title>
<link rel="stylesheet"
 href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
<style>
:root{--orange:#ff6600;--radius:12px;--anim:.18s cubic-bezier(.25,.8,.5,1)}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{margin:0;height:100%;font:-apple-system-body;
 font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
 background:#f7f7f7}
header{background:var(--orange);color:#fff;padding:.75rem 1.2rem;font-weight:600;font-size:1.15rem}
#toolbar{display:flex;gap:.6rem;padding:.55rem 1rem}
.tbtn{background:var(--orange);color:#fff;border:0;border-radius:var(--radius);
 width:36px;height:36px;font-size:1.5rem;display:flex;align-items:center;justify-content:center;
 cursor:pointer;transition:opacity var(--anim)}
.tbtn:active{opacity:.7}#filter,#showAll{display:none}
ul#stories{list-style:none;margin:0;padding:0}
li.story{background:#fff;margin:.55rem 0;padding:.9rem 1rem;border-radius:var(--radius);
 display:flex;align-items:center;gap:.85rem;position:relative;touch-action:none;
 box-shadow:0 1px 2px rgba(0,0,0,.06)}
.drag-handle{font-size:1.35rem;cursor:grab}
.menu-btn{font-size:1.55rem;cursor:pointer;color:#555;padding:.25rem}
.comment{font-size:1.28rem;text-decoration:none;color:#666}
a.title{flex:1;font-size:1rem;font-weight:500;text-decoration:none;color:#000}
.points{background:var(--orange);color:#fff;border-radius:6px;padding:.22rem .6rem;font-size:.75rem}
.checkbox{display:none;margin-right:.3rem}.selecting .checkbox{display:block}
.checkbox input{width:22px;height:22px}
.swipe-delete{position:absolute;top:0;right:-80px;height:100%;
 display:flex;align-items:center;padding:0 .8rem;transition:right var(--anim)}
.swipe-delete button{background:#e74c3c;border:0;border-radius:8px;padding:.6rem .9rem;font-size:1.05rem;color:#fff}
#fab{position:fixed;bottom:calc(env(safe-area-inset-bottom)+1rem);left:50%;
 transform:translateX(-50%);background:var(--orange);color:#fff;border-radius:999px;
 padding:.65rem 1.4rem;font-weight:600;display:none;box-shadow:0 4px 14px rgba(0,0,0,.2)}
#modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;
 justify-content:center;padding:1rem;z-index:900}
#modal .card{background:#fff;border-radius:var(--radius);max-width:660px;width:100%;
 max-height:90vh;overflow:auto;padding:1rem;position:relative}
#modal header{font-size:1.25rem;font-weight:700;margin-bottom:.5rem}
#modal .close{position:absolute;top:.4rem;right:.8rem;font-size:1.6rem;cursor:pointer;color:#555}
.copy-btn{margin-top:.75rem;background:#2ecc71;color:#fff;border:0;border-radius:8px;padding:.6rem 1.15rem;font-size:1rem}
.toast{position:fixed;top:0;left:0;right:0;background:#333;color:#fff;text-align:center;
 padding:.4rem 0;font-size:.9rem;transform:translateY(-120%);transition:transform var(--anim);z-index:950}
.toast.show{transform:translateY(0)}
.sheet{position:fixed;background:#fff;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,.25);
 overflow:hidden;z-index:1100}
.sheet button{display:block;width:100%;text-align:left;padding:.8rem 1.1rem;border:0;
 background:#fff;font-size:.95rem;color:#222}
.sheet button:hover{background:#f2f2f2}
</style>
</head><body>
<header>Hacker News -- Simple</header>
<div id="toolbar">
 <button id="refresh" class="tbtn">‚ü≥</button>
 <button id="select"  class="tbtn">‚òë</button>
 <button id="filter"  class="tbtn">üëÅ</button>
 <button id="showAll" class="tbtn">üîÑ</button>
</div>
<ul id="stories"></ul>
<button id="fab"></button>

<!-- Modal -->
<div id="modal"><div class="card">
 <span class="close">√ó</span>
 <header id="modal-title"></header>
 <div id="modal-body"></div>
</div></div>
<div id="toast" class="toast">Copied</div>

<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
<script>
const MAX_STORIES=30;
const list       = document.getElementById("stories"),
      fab        = document.getElementById("fab"),
      btnRefresh = document.getElementById("refresh"),
      btnSelect  = document.getElementById("select"),
      btnFilter  = document.getElementById("filter"),
      btnShowAll = document.getElementById("showAll"),
      toast      = document.getElementById("toast");

let stories=[],selectMode=false,filterActive=false,sortable,sheet,sheetT;

//// helpers
const vibrate=n=>{try{navigator.vibrate(n);}catch{}};
const showToast=t=>{toast.textContent=t;toast.classList.add("show");
 setTimeout(()=>toast.classList.remove("show"),1400)};
const modal=(t,html)=>{const m=document.getElementById("modal");m.style.display="flex";
 document.getElementById("modal-title").textContent=t;
 document.getElementById("modal-body").innerHTML=html;
 m.querySelector(".close").onclick=()=>m.style.display="none"};
const copyText=id=>navigator.clipboard.writeText(document.getElementById(id).value)
 .then(()=>showToast("Copied"));
function openSheet(dom,x,y){
 clearTimeout(sheetT);sheet?.remove();sheet=dom;document.body.appendChild(sheet);
 sheet.style.width="190px";sheet.style.left=Math.max(8,x-95)+"px";
 sheet.style.top=(y+10)+"px";
 sheetT=setTimeout(()=>{sheet?.remove();sheet=null},4000);
 setTimeout(()=>document.addEventListener("click",()=>{sheet?.remove();sheet=null},{once:true}));
}

//// data load (Firebase ‚Üí Algolia fallback)
// ‚ö†Ô∏è replace your entire loadStories() with THIS
async function loadStories () {
  btnRefresh.disabled = true;
  btnRefresh.textContent = "‚è≥";
  list.innerHTML = "";

  try {
    // --- single source: Algolia front page ----------
    const res = await fetch("https://hn.algolia.com/api/v1/search?tags=front_page");
    if (!res.ok) throw new Error("HTTP "+res.status+" "+res.statusText);
    const alg   = await res.json();

    stories = alg.hits.slice(0, MAX_STORIES).map(h => ({
      id   : h.objectID,
      title: h.title || "(no title)",
      url  : h.url   || `https://news.ycombinator.com/item?id=${h.objectID}`,
      score: h.points|| 0
    }));

    render();
    vibrate(30);
  } catch (err) {
    console.error(err);         // still visible if you someday open Web Inspector
    list.innerHTML =
      `<p style="padding:2rem">
         Couldn‚Äôt load Hacker News:<br>
         <code>${err.message}</code><br><br>
         <button id="retry">Retry</button>
       </p>`;
    retry.onclick = loadStories;
  } finally {
    btnRefresh.disabled = false;
    btnRefresh.textContent = "‚ü≥";
  }
}

//// render
function render(){
 list.innerHTML="";stories.forEach((s,i)=>list.appendChild(row(s,i)));
 if(!sortable)sortable=Sortable.create(list,{handle:".drag-handle",animation:150,
  onEnd:e=>{const [m]=stories.splice(e.oldIndex,1);stories.splice(e.newIndex,0,m);}});
 updateUI();
}
const row=(s,i)=>{const li=document.createElement("li");
 li.className="story";li.dataset.index=i;
 li.innerHTML=`<span class="drag-handle">‚ò∞</span>
   <label class="checkbox"><input type="checkbox"></label>
   <a class="title" href="${s.url}" target="_blank">${s.title}</a>
   <span class="points">${s.score}</span>
   <a class="comment" href="https://news.ycombinator.com/item?id=${s.id}" target="_blank">üí¨</a>
   <span class="menu-btn">‚ãØ</span>
   <div class="swipe-delete"><button class="remove">üóë</button></div>`;
 wire(li);return li};
function wire(li){
 const mc=new Hammer(li);mc.get("swipe").set({direction:Hammer.DIRECTION_HORIZONTAL,velocity:0.2});
 mc.on("swipeleft",()=>li.querySelector(".swipe-delete").style.right="0");
 mc.on("swiperight",()=>li.querySelector(".swipe-delete").style.right="-80px");
 li.querySelector(".remove").onclick=()=>{stories.splice(li.dataset.index,1);li.remove();updateUI()};
 li.querySelector("input").addEventListener("change",updateUI);
 li.querySelector(".menu-btn").onclick=e=>{
   const i=li.dataset.index,node=document.createElement("div");node.className="sheet";
   node.innerHTML=`<button id="ms">Summarize</button>
    <button id="mh">Hide others</button>
    <button id="mc">Open comments</button>
    <button id="mr">Remove</button>`;
   openSheet(node,e.clientX,e.clientY);
   node.ms.onclick=()=>{sheet.remove();summarize([stories[i]]);};
   node.mh.onclick=()=>{sheet.remove();hideOthers([li]);};
   node.mc.onclick=()=>{window.open(\`https://news.ycombinator.com/item?id=\${stories[i].id}\`,'_blank');sheet.remove();};
   node.mr.onclick=()=>{li.querySelector(".remove").click();sheet.remove();};
   e.stopPropagation();
 };
}

//// select / filter
btnSelect.onclick=()=>{selectMode=!selectMode;list.classList.toggle("selecting",selectMode);
 if(!selectMode)list.querySelectorAll("input").forEach(cb=>cb.checked=false);updateUI()};
const selectedLis=()=>[...list.children].filter(li=>li.querySelector("input").checked);
btnFilter.onclick=()=>hideOthers(selectedLis());
btnShowAll.onclick=()=>{[...list.children].forEach(li=>li.style.display="flex");
 filterActive=false;updateUI()};
function hideOthers(keep){[...list.children].forEach(li=>li.style.display="none");
 keep.forEach(li=>li.style.display="flex");
 filterActive=true;selectMode=false;list.classList.remove("selecting");updateUI();}
function updateUI(){
 const c=selectedLis().length;fab.style.display=c&&selectMode?"block":"none";
 fab.textContent=c?`${c} selected`:"";
 btnFilter.style.display=c&&!filterActive?"inline-block":"none";
 btnShowAll.style.display=filterActive?"inline-block":"none";
}
fab.onclick=()=>summarize(selectedLis().map(li=>stories[li.dataset.index]));

//// summarize
const buildPrompt=(t,u)=>`‚Ä¢ 5 concise bullet points summarizing "${t}".\n`+
 "‚Ä¢ Add an analogy or concrete scenario to make the idea clear.\n"+
 "‚Ä¢ One sentence on why this could be interesting or significant.\n"+
 `URL: ${u}`;
function summarize(arr){
 const txt=arr.map(a=>`**${a.title}**\n${buildPrompt(a.title,a.url)}`).join("\n\n");
 modal("Copy these prompts",
  `<textarea id="copyBox" readonly rows="14" style="width:100%">${txt}</textarea>
   <button class="copy-btn" onclick="copyText('copyBox')">Copy üìã</button>`);
}

//// boot
btnRefresh.onclick=loadStories;loadStories();
</script>
</body></html>