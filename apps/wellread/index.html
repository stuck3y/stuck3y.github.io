<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Well Read">
<meta name="theme-color" content="#F5F0EB">
<title>Well Read 1.001</title>
<link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiV2VsbCBSZWFkIiwic2hvcnRfbmFtZSI6IldlbGwgUmVhZCIsInN0YXJ0X3VybCI6Ii4iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjRjVGMEVCIiwidGhlbWVfY29sb3IiOiIjRjVGMEVCIn0=">
<style>
@import url('https://fonts.googleapis.com/css2?family=Newsreader:ital,opsz,wght@0,6..72,300;0,6..72,400;0,6..72,500;0,6..72,600;1,6..72,300;1,6..72,400&family=DM+Sans:wght@400;500;600&display=swap');

:root {
â€“bg: #F5F0EB;
â€“bg-card: #FFFFFF;
â€“bg-elevated: #FDFCFA;
â€“text-primary: #1A1613;
â€“text-secondary: #6B5E52;
â€“text-tertiary: #9C8E80;
â€“accent: #8B6B4A;
â€“accent-light: #C4A882;
â€“accent-bg: #F0E8DE;
â€“border: #E8E0D6;
â€“border-light: #F0EBE5;
â€“observation: #5B7B6A;
â€“observation-bg: #EDF4EF;
â€“interpretation: #6A6B8A;
â€“interpretation-bg: #EDEDF4;
â€“application: #8A6A5B;
â€“application-bg: #F4EDEB;
â€“success: #5B7B6A;
â€“shadow-sm: 0 1px 3px rgba(26,22,19,0.04);
â€“shadow-md: 0 4px 12px rgba(26,22,19,0.06);
â€“shadow-lg: 0 8px 24px rgba(26,22,19,0.08);
â€“radius-sm: 10px;
â€“radius-md: 14px;
â€“radius-lg: 20px;
â€“serif: â€˜Newsreaderâ€™, Georgia, serif;
â€“sans: â€˜DM Sansâ€™, -apple-system, BlinkMacSystemFont, sans-serif;
â€“safe-top: env(safe-area-inset-top, 0px);
â€“safe-bottom: env(safe-area-inset-bottom, 0px);
}

- { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; touch-action: manipulation; }

html, body {
font-family: var(â€“sans);
background: var(â€“bg);
color: var(â€“text-primary);
min-height: 100dvh;
overscroll-behavior: none;
-webkit-font-smoothing: antialiased;
}

body { padding-top: var(â€“safe-top); padding-bottom: calc(72px + var(â€“safe-bottom)); }

/* ===== ANIMATIONS ===== */
@keyframes fadeUp {
from { opacity: 0; transform: translateY(12px); }
to { opacity: 1; transform: translateY(0); }
}
@keyframes fadeIn {
from { opacity: 0; }
to { opacity: 1; }
}
@keyframes slideIn {
from { opacity: 0; transform: translateX(20px); }
to { opacity: 1; transform: translateX(0); }
}
@keyframes scaleIn {
from { opacity: 0; transform: scale(0.95); }
to { opacity: 1; transform: scale(1); }
}

.animate-fade-up { animation: fadeUp 0.4s ease-out both; }
.animate-fade-in { animation: fadeIn 0.3s ease-out both; }
.animate-slide-in { animation: slideIn 0.35s ease-out both; }
.animate-scale-in { animation: scaleIn 0.3s ease-out both; }

/* ===== TAB BAR ===== */
.tab-bar {
position: fixed;
bottom: 0;
left: 0;
right: 0;
display: flex;
justify-content: space-around;
align-items: center;
background: rgba(255,255,255,0.88);
backdrop-filter: blur(20px);
-webkit-backdrop-filter: blur(20px);
border-top: 1px solid var(â€“border-light);
padding: 8px 0 calc(8px + var(â€“safe-bottom));
z-index: 100;
}

.tab-btn {
display: flex;
flex-direction: column;
align-items: center;
gap: 2px;
background: none;
border: none;
font-family: var(â€“sans);
font-size: 10px;
font-weight: 500;
color: var(â€“text-tertiary);
cursor: pointer;
padding: 4px 16px;
transition: color 0.2s;
}
.tab-btn.active { color: var(â€“accent); }
.tab-btn svg { width: 24px; height: 24px; transition: transform 0.2s; }
.tab-btn.active svg { transform: scale(1.08); }

/* ===== SCREENS ===== */
.screen { display: none; padding: 20px; max-width: 520px; margin: 0 auto; }
.screen.active { display: block; }

/* ===== HEADER ===== */
.screen-header {
padding: 16px 0 20px;
}
.screen-header h1 {
font-family: var(â€“serif);
font-size: 32px;
font-weight: 500;
letter-spacing: -0.5px;
color: var(â€“text-primary);
}
.screen-header p {
font-size: 15px;
color: var(â€“text-secondary);
margin-top: 4px;
line-height: 1.4;
}

/* ===== HOME SCREEN ===== */
.passage-input-card {
background: var(â€“bg-card);
border-radius: var(â€“radius-lg);
padding: 24px;
box-shadow: var(â€“shadow-md);
margin-bottom: 20px;
}
.passage-input-card label {
font-size: 13px;
font-weight: 600;
color: var(â€“text-secondary);
text-transform: uppercase;
letter-spacing: 0.8px;
display: block;
margin-bottom: 10px;
}
.passage-ref-input {
width: 100%;
font-family: var(â€“serif);
font-size: 20px;
border: none;
background: none;
color: var(â€“text-primary);
outline: none;
padding: 8px 0;
border-bottom: 2px solid var(â€“border);
transition: border-color 0.2s;
}
.passage-ref-input:focus { border-color: var(â€“accent); }
.passage-ref-input::placeholder { color: var(â€“text-tertiary); }

.passage-text-input {
width: 100%;
font-family: var(â€“serif);
font-size: 16px;
line-height: 1.6;
border: none;
background: var(â€“bg);
color: var(â€“text-primary);
outline: none;
padding: 14px 16px;
border-radius: var(â€“radius-md);
resize: none;
min-height: 100px;
margin-top: 14px;
transition: box-shadow 0.2s;
}
.passage-text-input:focus { box-shadow: inset 0 0 0 2px var(â€“accent-light); }
.passage-text-input::placeholder { color: var(â€“text-tertiary); }

.begin-btn {
width: 100%;
padding: 16px;
background: var(â€“accent);
color: white;
border: none;
border-radius: var(â€“radius-md);
font-family: var(â€“sans);
font-size: 16px;
font-weight: 600;
cursor: pointer;
margin-top: 16px;
transition: all 0.2s;
-webkit-appearance: none;
appearance: none;
}
.begin-btn:active { transform: scale(0.98); opacity: 0.9; }
.begin-btn:disabled { opacity: 0.4; cursor: default; }

/* Safari tap fix â€” all interactive elements */
button, .study-card, .history-card { cursor: pointer; -webkit-appearance: none; }

/* ===== RECENT STUDIES ===== */
.section-label {
font-size: 13px;
font-weight: 600;
color: var(â€“text-secondary);
text-transform: uppercase;
letter-spacing: 0.8px;
margin-bottom: 12px;
}

.study-card {
background: var(â€“bg-card);
border-radius: var(â€“radius-md);
padding: 16px 18px;
box-shadow: var(â€“shadow-sm);
margin-bottom: 10px;
cursor: pointer;
transition: all 0.2s;
display: flex;
justify-content: space-between;
align-items: center;
}
.study-card:active { transform: scale(0.98); background: var(â€“bg-elevated); }
.study-card-left h3 {
font-family: var(â€“serif);
font-size: 18px;
font-weight: 500;
}
.study-card-left p {
font-size: 13px;
color: var(â€“text-tertiary);
margin-top: 3px;
}
.study-card-phase {
font-size: 11px;
font-weight: 600;
padding: 4px 10px;
border-radius: 20px;
text-transform: uppercase;
letter-spacing: 0.5px;
white-space: nowrap;
}
.phase-observation { background: var(â€“observation-bg); color: var(â€“observation); }
.phase-interpretation { background: var(â€“interpretation-bg); color: var(â€“interpretation); }
.phase-application { background: var(â€“application-bg); color: var(â€“application); }
.phase-complete { background: var(â€“accent-bg); color: var(â€“accent); }

/* ===== STUDY SCREEN ===== */
.study-nav {
display: flex;
align-items: center;
padding: 12px 0;
gap: 12px;
}
.back-btn {
background: none;
border: none;
cursor: pointer;
color: var(â€“accent);
font-size: 16px;
font-weight: 500;
font-family: var(â€“sans);
display: flex;
align-items: center;
gap: 4px;
padding: 4px 0;
}
.back-btn svg { width: 20px; height: 20px; }

.study-passage-display {
background: var(â€“bg-card);
border-radius: var(â€“radius-lg);
padding: 20px 22px;
box-shadow: var(â€“shadow-sm);
margin-bottom: 20px;
border-left: 3px solid var(â€“accent-light);
}
.study-passage-display h2 {
font-family: var(â€“serif);
font-size: 22px;
font-weight: 500;
margin-bottom: 8px;
}
.study-passage-display .passage-text {
font-family: var(â€“serif);
font-size: 15px;
line-height: 1.7;
color: var(â€“text-secondary);
font-style: italic;
max-height: 120px;
overflow-y: auto;
}
.study-passage-display .passage-text.expanded { max-height: none; }
.toggle-passage {
background: none;
border: none;
color: var(â€“accent);
font-size: 13px;
font-weight: 500;
cursor: pointer;
margin-top: 6px;
font-family: var(â€“sans);
}

/* Phase tabs */
.phase-tabs {
display: flex;
gap: 6px;
margin-bottom: 20px;
background: var(â€“bg-card);
padding: 4px;
border-radius: var(â€“radius-md);
box-shadow: var(â€“shadow-sm);
}
.phase-tab {
flex: 1;
padding: 10px 8px;
border: none;
border-radius: var(â€“radius-sm);
font-family: var(â€“sans);
font-size: 13px;
font-weight: 600;
cursor: pointer;
background: none;
color: var(â€“text-tertiary);
transition: all 0.25s;
text-align: center;
}
.phase-tab.active-observation { background: var(â€“observation-bg); color: var(â€“observation); }
.phase-tab.active-interpretation { background: var(â€“interpretation-bg); color: var(â€“interpretation); }
.phase-tab.active-application { background: var(â€“application-bg); color: var(â€“application); }

/* Prompt cards */
.prompt-section { margin-bottom: 16px; }
.prompt-card {
background: var(â€“bg-card);
border-radius: var(â€“radius-md);
padding: 18px 20px;
box-shadow: var(â€“shadow-sm);
margin-bottom: 12px;
animation: fadeUp 0.35s ease-out both;
}
.prompt-card-header {
display: flex;
justify-content: space-between;
align-items: flex-start;
margin-bottom: 10px;
}
.prompt-card h3 {
font-family: var(â€“sans);
font-size: 15px;
font-weight: 600;
color: var(â€“text-primary);
line-height: 1.4;
flex: 1;
}
.prompt-card .book-ref {
font-size: 11px;
color: var(â€“text-tertiary);
font-weight: 500;
background: var(â€“bg);
padding: 3px 8px;
border-radius: 6px;
white-space: nowrap;
margin-left: 10px;
}
.prompt-card p {
font-size: 14px;
color: var(â€“text-secondary);
line-height: 1.5;
margin-bottom: 12px;
}
.prompt-response {
width: 100%;
font-family: var(â€“serif);
font-size: 15px;
line-height: 1.6;
border: 1.5px solid var(â€“border);
background: var(â€“bg);
color: var(â€“text-primary);
outline: none;
padding: 12px 14px;
border-radius: var(â€“radius-sm);
resize: none;
min-height: 72px;
transition: border-color 0.2s;
}
.prompt-response:focus { border-color: var(â€“accent); }
.prompt-response::placeholder { color: var(â€“text-tertiary); font-style: italic; }

.phase-nav-btns {
display: flex;
gap: 10px;
margin-top: 8px;
margin-bottom: 20px;
}
.phase-nav-btn {
flex: 1;
padding: 14px;
border-radius: var(â€“radius-md);
font-family: var(â€“sans);
font-size: 15px;
font-weight: 600;
cursor: pointer;
border: none;
transition: all 0.2s;
}
.phase-nav-btn:active { transform: scale(0.98); }
.phase-nav-btn.secondary {
background: var(â€“bg-card);
color: var(â€“text-secondary);
box-shadow: var(â€“shadow-sm);
}
.phase-nav-btn.primary {
background: var(â€“accent);
color: white;
}
.phase-nav-btn.complete-btn {
background: var(â€“success);
color: white;
}

/* ===== REVIEW SCREEN ===== */
.review-card {
background: var(â€“bg-card);
border-radius: var(â€“radius-lg);
padding: 28px 24px;
box-shadow: var(â€“shadow-md);
text-align: center;
margin-bottom: 16px;
min-height: 200px;
display: flex;
flex-direction: column;
justify-content: center;
}
.review-card .question {
font-family: var(â€“serif);
font-size: 20px;
font-weight: 400;
line-height: 1.5;
color: var(â€“text-primary);
margin-bottom: 8px;
}
.review-card .book-ref {
font-size: 12px;
color: var(â€“text-tertiary);
font-weight: 500;
}
.review-answer {
background: var(â€“accent-bg);
border-radius: var(â€“radius-md);
padding: 20px;
margin-bottom: 16px;
animation: scaleIn 0.3s ease-out;
}
.review-answer p {
font-family: var(â€“serif);
font-size: 16px;
line-height: 1.6;
color: var(â€“text-primary);
}
.review-btns {
display: flex;
gap: 10px;
}
.review-btn {
flex: 1;
padding: 14px;
border-radius: var(â€“radius-md);
font-family: var(â€“sans);
font-size: 15px;
font-weight: 600;
cursor: pointer;
border: none;
transition: all 0.2s;
}
.review-btn:active { transform: scale(0.98); }
.review-btn.reveal { background: var(â€“accent); color: white; }
.review-btn.knew { background: var(â€“success); color: white; }
.review-btn.didnt { background: var(â€“bg-card); color: var(â€“text-secondary); box-shadow: var(â€“shadow-sm); }
.review-btn.next { background: var(â€“accent); color: white; }

.review-progress {
text-align: center;
font-size: 13px;
color: var(â€“text-tertiary);
margin-bottom: 20px;
}

.streak-display {
background: var(â€“bg-card);
border-radius: var(â€“radius-md);
padding: 16px 20px;
box-shadow: var(â€“shadow-sm);
display: flex;
align-items: center;
gap: 14px;
margin-bottom: 20px;
}
.streak-number {
font-family: var(â€“serif);
font-size: 36px;
font-weight: 600;
color: var(â€“accent);
line-height: 1;
}
.streak-label {
font-size: 13px;
color: var(â€“text-secondary);
line-height: 1.3;
}
.streak-label strong { color: var(â€“text-primary); display: block; font-size: 14px; }

/* ===== HISTORY SCREEN ===== */
.empty-state {
text-align: center;
padding: 48px 24px;
color: var(â€“text-tertiary);
}
.empty-state .icon { font-size: 40px; margin-bottom: 12px; opacity: 0.5; }
.empty-state p { font-size: 15px; line-height: 1.5; }

.history-card {
background: var(â€“bg-card);
border-radius: var(â€“radius-md);
padding: 16px 18px;
box-shadow: var(â€“shadow-sm);
margin-bottom: 10px;
cursor: pointer;
transition: all 0.2s;
}
.history-card:active { transform: scale(0.98); }
.history-card-top {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 6px;
}
.history-card h3 {
font-family: var(â€“serif);
font-size: 18px;
font-weight: 500;
}
.history-card .date {
font-size: 12px;
color: var(â€“text-tertiary);
}
.history-card .preview {
font-size: 13px;
color: var(â€“text-secondary);
line-height: 1.4;
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
overflow: hidden;
}
.delete-study-btn {
background: none;
border: none;
color: #C0392B;
font-size: 13px;
font-weight: 500;
cursor: pointer;
padding: 8px 0;
font-family: var(â€“sans);
margin-top: 6px;
}

/* ===== UTILITY ===== */
.mt-8 { margin-top: 8px; }
.mt-16 { margin-top: 16px; }
.mb-20 { margin-bottom: 20px; }
.hidden { display: none !important; }

/* ===== COMPLETION SUMMARY ===== */
.summary-header {
text-align: center;
padding: 24px 0 20px;
}
.summary-header .check {
width: 56px;
height: 56px;
background: var(â€“success);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
margin: 0 auto 16px;
}
.summary-header .check svg { width: 28px; height: 28px; color: white; }
.summary-header h2 {
font-family: var(â€“serif);
font-size: 26px;
font-weight: 500;
}
.summary-header p {
font-size: 14px;
color: var(â€“text-secondary);
margin-top: 4px;
}
.summary-section {
margin-bottom: 16px;
}
.summary-section-label {
font-size: 12px;
font-weight: 600;
text-transform: uppercase;
letter-spacing: 0.8px;
padding: 6px 12px;
border-radius: 8px;
display: inline-block;
margin-bottom: 10px;
}
.summary-section-label.obs { background: var(â€“observation-bg); color: var(â€“observation); }
.summary-section-label.int { background: var(â€“interpretation-bg); color: var(â€“interpretation); }
.summary-section-label.app { background: var(â€“application-bg); color: var(â€“application); }
.summary-entry {
background: var(â€“bg-card);
border-radius: var(â€“radius-md);
padding: 14px 16px;
box-shadow: var(â€“shadow-sm);
margin-bottom: 8px;
}
.summary-entry h4 {
font-size: 13px;
font-weight: 600;
color: var(â€“text-secondary);
margin-bottom: 6px;
}
.summary-entry p {
font-family: var(â€“serif);
font-size: 15px;
line-height: 1.6;
color: var(â€“text-primary);
white-space: pre-wrap;
}
.summary-done-btn {
width: 100%;
padding: 16px;
background: var(â€“accent);
color: white;
border: none;
border-radius: var(â€“radius-md);
font-family: var(â€“sans);
font-size: 16px;
font-weight: 600;
cursor: pointer;
margin-top: 12px;
margin-bottom: 24px;
-webkit-appearance: none;
}
.summary-done-btn:active { transform: scale(0.98); }
</style>

</head>
<body>

<!-- ===== HOME SCREEN ===== -->

<div id="screen-home" class="screen active">
  <div class="screen-header animate-fade-up">
    <h1>Well Read</h1>
    <p>Study the Word with method and care.</p>
  </div>

  <div class="passage-input-card animate-fade-up" style="animation-delay: 0.05s">
    <label>New Study</label>
    <input type="text" class="passage-ref-input" id="passage-ref" placeholder="e.g. John 3:1-17" autocomplete="off">
    <textarea class="passage-text-input" id="passage-text" placeholder="Paste the passage text here (optional but recommended)â€¦"></textarea>
    <button class="begin-btn" id="begin-study-btn" disabled>Begin Study</button>
  </div>

  <div id="recent-studies" class="hidden">
    <div class="section-label">Continue</div>
    <div id="recent-studies-list"></div>
  </div>
</div>

<!-- ===== STUDY SCREEN ===== -->

<div id="screen-study" class="screen">
  <div class="study-nav">
    <button class="back-btn" id="study-back-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
      Back
    </button>
  </div>

  <div class="study-passage-display animate-fade-up" id="study-passage-display">
    <h2 id="study-passage-ref"></h2>
    <div class="passage-text" id="study-passage-text"></div>
    <button class="toggle-passage hidden" id="toggle-passage-btn">Show more</button>
  </div>

  <div class="phase-tabs animate-fade-up" style="animation-delay: 0.05s">
    <button class="phase-tab" data-phase="observation" id="tab-observation">Observe</button>
    <button class="phase-tab" data-phase="interpretation" id="tab-interpretation">Interpret</button>
    <button class="phase-tab" data-phase="application" id="tab-application">Apply</button>
  </div>

  <div id="prompts-container"></div>

  <div class="phase-nav-btns" id="phase-nav-btns"></div>
</div>

<!-- ===== REVIEW SCREEN ===== -->

<div id="screen-review" class="screen">
  <div class="screen-header animate-fade-up">
    <h1>Review</h1>
    <p>Sharpen the method. Keep it fresh.</p>
  </div>

  <div id="review-streak" class="streak-display animate-fade-up" style="animation-delay: 0.05s">
    <div class="streak-number" id="streak-count">0</div>
    <div class="streak-label">
      <strong>Cards reviewed today</strong>
      Keep the techniques sharp
    </div>
  </div>

  <div class="review-progress" id="review-progress"></div>
  <div id="review-card-container"></div>
  <div id="review-btns-container"></div>
</div>

<!-- ===== HISTORY SCREEN ===== -->

<div id="screen-history" class="screen">
  <div class="screen-header animate-fade-up">
    <h1>History</h1>
    <p>Past studies to revisit.</p>
  </div>
  <div id="history-list"></div>
</div>

<!-- ===== SUMMARY SCREEN ===== -->

<div id="screen-summary" class="screen">
  <div class="summary-header animate-fade-up">
    <div class="check">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
    </div>
    <h2 id="summary-ref"></h2>
    <p>Study complete</p>
  </div>
  <div id="summary-content"></div>
  <button class="summary-done-btn" id="summary-done-btn">Done</button>
</div>

<!-- ===== TAB BAR ===== -->

<nav class="tab-bar">
  <button class="tab-btn active" data-screen="home">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19V9l8-5.5L20 9v10a1 1 0 01-1 1h-4v-6h-6v6H5a1 1 0 01-1-1z"/></svg>
    Study
  </button>
  <button class="tab-btn" data-screen="review">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="18" rx="2"/><path d="M8 7v10M12 7v10M16 7v10"/></svg>
    Review
  </button>
  <button class="tab-btn" data-screen="history">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
    History
  </button>
</nav>

<script>
// ============================================================
// LBTB DATA â€” Hendricks' Inductive Method
// ============================================================

const STUDY_PROMPTS = {
  observation: [
    {
      id: 'obs-read-multiple',
      title: 'Read It Again (and Again)',
      description: 'Read the passage at least 3 times. Each time, jot down something new you notice. The goal is to see what\'s actually there before jumping to meaning.',
      bookRef: 'Ch. 4â€“6',
      placeholder: 'What did you notice on each reading?'
    },
    {
      id: 'obs-key-words',
      title: 'What Are the Key Words?',
      description: 'Identify the most important words â€” the ones the passage can\'t do without. Look for terms that carry theological weight or are central to the author\'s point.',
      bookRef: 'Ch. 8',
      placeholder: 'List the key words you seeâ€¦'
    },
    {
      id: 'obs-repetition',
      title: 'What Is Repeated?',
      description: 'Repetition is the author\'s way of saying "this matters." Look for repeated words, phrases, ideas, or patterns.',
      bookRef: 'Ch. 6',
      placeholder: 'What words, phrases, or ideas are repeated?'
    },
    {
      id: 'obs-contrasts',
      title: 'Are There Contrasts or Comparisons?',
      description: 'Authors often make their point by setting things side by side â€” light vs. dark, flesh vs. spirit, wise vs. foolish. What is being compared or contrasted?',
      bookRef: 'Ch. 6',
      placeholder: 'List any contrasts or comparisonsâ€¦'
    },
    {
      id: 'obs-connectives',
      title: 'What Connecting Words Do You See?',
      description: 'Words like "therefore," "but," "because," "so that," and "ifâ€¦then" are the joints of the passage. They reveal the logic and flow of the argument.',
      bookRef: 'Ch. 5',
      placeholder: 'List connecting words and what they linkâ€¦'
    },
    {
      id: 'obs-questions',
      title: 'Ask the Six Key Questions',
      description: 'Who? What? Where? When? Why? Wherefore? â€” Go through each one. "Wherefore" means "for what purpose?" It digs into intent and design. Not all will apply, but the discipline of asking forces careful observation.',
      bookRef: 'Ch. 7',
      placeholder: 'Work through: Who, What, Where, When, Why, Whereforeâ€¦'
    },
    {
      id: 'obs-structure',
      title: 'What Is the Structure?',
      description: 'How is the passage organized? Is it a narrative with a beginning, middle, end? A logical argument? A list? A chiasm? Try to outline the basic flow.',
      bookRef: 'Ch. 9',
      placeholder: 'Describe the passage structure or outline itâ€¦'
    }
  ],
  interpretation: [
    {
      id: 'int-context',
      title: 'What Is the Context?',
      description: 'Context is king. What comes before and after this passage? What\'s the book\'s overall argument or story? Never read a verse in isolation.',
      bookRef: 'Ch. 15',
      placeholder: 'Describe the surrounding contextâ€¦'
    },
    {
      id: 'int-cross-ref',
      title: 'Do Other Scriptures Shed Light?',
      description: 'Let Scripture interpret Scripture. Are there parallel passages, cross-references, or other places where the same theme, word, or idea appears?',
      bookRef: 'Ch. 16',
      placeholder: 'List cross-references and what they clarifyâ€¦'
    },
    {
      id: 'int-culture',
      title: 'What Is the Historical/Cultural Background?',
      description: 'What would the original audience have understood that you might miss? Consider customs, geography, politics, and social realities of the time.',
      bookRef: 'Ch. 17',
      placeholder: 'What historical or cultural background is relevant?'
    },
    {
      id: 'int-genre',
      title: 'What Is the Literary Genre?',
      description: 'Is this narrative, poetry, prophecy, epistle, wisdom, apocalyptic? Each genre has its own rules for interpretation. Don\'t read a psalm like a legal contract.',
      bookRef: 'Ch. 18',
      placeholder: 'What genre is this and how does that shape your reading?'
    },
    {
      id: 'int-author-intent',
      title: 'What Did the Author Mean?',
      description: 'The goal of interpretation is to discover the author\'s intended meaning to the original audience. Not what it means to you â€” what did it mean to them?',
      bookRef: 'Ch. 14',
      placeholder: 'What was the author communicating to the original audience?'
    },
    {
      id: 'int-summary',
      title: 'State the Meaning in One Sentence',
      description: 'If you can\'t say it simply, you may not understand it yet. Boil the passage down to one clear sentence that captures the main point.',
      bookRef: 'Ch. 19',
      placeholder: 'The main point of this passage isâ€¦'
    }
  ],
  application: [
    {
      id: 'app-spacepets',
      title: 'Scan for Application Categories',
      description: 'Use the SPACEPETS grid: Is there a Sin to avoid? Promise to claim? Attitude to change? Command to obey? Example to follow? Prayer to pray? Error to avoid? Truth to believe? Something to praise God for?',
      bookRef: 'Ch. 22',
      placeholder: 'Which categories apply? Write them outâ€¦'
    },
    {
      id: 'app-personal',
      title: 'How Does This Apply to YOUR Life?',
      description: 'Application must be personal, practical, and specific. Not "people should love more" but "I need to show patience with [specific person] this week by [specific action]."',
      bookRef: 'Ch. 21',
      placeholder: 'Write a specific, personal applicationâ€¦'
    },
    {
      id: 'app-measurable',
      title: 'Make It Measurable',
      description: 'Hendricks insists: vague application is no application. What will you do? When? How will you know you\'ve done it? Write it so you could check it off.',
      bookRef: 'Ch. 23',
      placeholder: 'What specifically will you do and when?'
    },
    {
      id: 'app-accountable',
      title: 'Who Will You Share This With?',
      description: 'Application sticks when it\'s shared. Who in your life can ask you about this? A spouse, friend, small group? Name them.',
      bookRef: 'Ch. 23',
      placeholder: 'Who will you share this application with?'
    }
  ]
};

// Review flashcards â€” techniques from the book
const REVIEW_CARDS = [
  { q: 'What are the three steps of the inductive Bible study method?', a: 'Observation (What do I see?), Interpretation (What does it mean?), Application (How does it work in my life?).', ref: 'Ch. 1â€“3' },
  { q: 'Why does Hendricks say you must observe BEFORE interpreting?', a: 'Because most errors in Bible study come from jumping to meaning before carefully seeing what the text actually says. Observation is the foundation.', ref: 'Ch. 4' },
  { q: 'What are the six interrogative questions to ask of any passage?', a: 'Who? What? Where? When? Why? Wherefore? ("Wherefore" means "for what purpose?" â€” it gets at intent and design.)', ref: 'Ch. 7' },
  { q: 'What should you look for when observing connecting words?', a: 'Words like therefore, but, because, so that, if/then, and for. They reveal the logical structure and flow of the argument.', ref: 'Ch. 5' },
  { q: 'Name at least 4 things to look for during Observation.', a: 'Repetition, contrasts, comparisons, connecting words, key words, lists, cause/effect, questions asked, figures of speech, and the overall structure.', ref: 'Ch. 6' },
  { q: 'What does Hendricks mean by "things that are emphasized"?', a: 'The author signals importance through repetition, proportion (amount of space given), placement (beginning or end), and stated purpose.', ref: 'Ch. 6' },
  { q: 'Why is context called "king" in interpretation?', a: 'Because the meaning of any verse depends on the verses around it, the chapter, the book, and the whole of Scripture. Ignoring context leads to misinterpretation.', ref: 'Ch. 15' },
  { q: 'What does "let Scripture interpret Scripture" mean?', a: 'When a passage is unclear, look to clearer passages on the same subject. The Bible is its own best commentary.', ref: 'Ch. 16' },
  { q: 'Why does genre matter in interpretation?', a: 'Different genres (narrative, poetry, prophecy, epistle, etc.) follow different literary rules. You can\'t interpret a psalm the same way you interpret a Pauline argument.', ref: 'Ch. 18' },
  { q: 'What is the goal of interpretation according to Hendricks?', a: 'To discover the author\'s original intended meaning to the original audience. It\'s not "what does it mean to me" but "what did it mean to them."', ref: 'Ch. 14' },
  { q: 'What does SPACEPETS stand for?', a: 'Sin to avoid, Promise to claim, Attitude to change, Command to obey, Example to follow, Prayer to pray, Error to avoid, Truth to believe, Something to praise God for.', ref: 'Ch. 22' },
  { q: 'What makes application effective according to Hendricks?', a: 'It must be personal (not abstract), practical (not theoretical), specific (not vague), and measurable (you can check whether you did it).', ref: 'Ch. 21â€“23' },
  { q: 'Why does Hendricks emphasize reading a passage multiple times?', a: 'Because each reading reveals something new. The first reading gives the big picture, subsequent readings reveal details, patterns, and things you initially missed.', ref: 'Ch. 4' },
  { q: 'What is the difference between an observation and an interpretation?', a: 'Observation says "I see X in the text." Interpretation says "X means Y." You must see it clearly before you can say what it means.', ref: 'Ch. 3' },
  { q: 'Why does Hendricks say to study books of the Bible, not just verses?', a: 'Because books are the basic unit of communication. Studying isolated verses without understanding the whole book leads to taking things out of context.', ref: 'Ch. 10' },
  { q: 'What role does historical/cultural background play in interpretation?', a: 'It helps you understand what the original audience would have understood â€” customs, geography, politics, social realities â€” that modern readers might miss.', ref: 'Ch. 17' }
];


// ============================================================
// STATE
// ============================================================

let state = {
  currentScreen: 'home',
  currentStudy: null,
  currentPhase: 'observation',
  reviewIndex: 0,
  reviewShowAnswer: false,
  reviewedToday: 0,
  reviewOrder: [],
  studies: []
};

function loadState() {
  try {
    const saved = localStorage.getItem('wellread_studies');
    if (saved) state.studies = JSON.parse(saved);
    const reviewed = localStorage.getItem('wellread_reviewed_today');
    const reviewDate = localStorage.getItem('wellread_review_date');
    const today = new Date().toDateString();
    if (reviewDate === today && reviewed) {
      state.reviewedToday = parseInt(reviewed);
    } else {
      state.reviewedToday = 0;
    }
  } catch(e) { console.error('Load error:', e); }
}

function saveStudies() {
  try {
    localStorage.setItem('wellread_studies', JSON.stringify(state.studies));
  } catch(e) { console.error('Save error:', e); }
}

function saveReviewCount() {
  try {
    localStorage.setItem('wellread_reviewed_today', state.reviewedToday.toString());
    localStorage.setItem('wellread_review_date', new Date().toDateString());
  } catch(e) {}
}


// ============================================================
// NAVIGATION
// ============================================================

function showScreen(name) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(`screen-${name}`).classList.add('active');
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  const tab = document.querySelector(`.tab-btn[data-screen="${name}"]`);
  if (tab) tab.classList.add('active');
  // Hide tab bar on study and summary screens
  document.querySelector('.tab-bar').style.display = (name === 'study' || name === 'summary') ? 'none' : 'flex';
  document.body.style.paddingBottom = (name === 'study' || name === 'summary') ? '20px' : 'calc(72px + var(--safe-bottom))';
  state.currentScreen = name;
  window.scrollTo(0, 0);

  if (name === 'home') renderHome();
  if (name === 'review') initReview();
  if (name === 'history') renderHistory();
}

// Event delegation for tab bar
document.querySelector('.tab-bar').addEventListener('click', function(e) {
  const btn = e.target.closest('.tab-btn');
  if (btn) showScreen(btn.dataset.screen);
});

// Event delegation for the entire document â€” handles all dynamic elements
document.addEventListener('click', function(e) {
  // Study cards on home
  const studyCard = e.target.closest('[data-action="open-study"]');
  if (studyCard) {
    openStudy(studyCard.dataset.studyId);
    return;
  }

  // History cards
  const historyCard = e.target.closest('[data-action="open-history"]');
  if (historyCard) {
    openStudy(historyCard.dataset.studyId);
    return;
  }

  // Delete study
  const deleteBtn = e.target.closest('[data-action="delete-study"]');
  if (deleteBtn) {
    e.stopPropagation();
    deleteStudy(deleteBtn.dataset.studyId);
    return;
  }

  // Phase tabs
  const phaseTab = e.target.closest('.phase-tab');
  if (phaseTab) {
    goPhase(phaseTab.dataset.phase);
    return;
  }

  // Phase nav buttons
  const phaseNav = e.target.closest('[data-action="go-phase"]');
  if (phaseNav) {
    goPhase(phaseNav.dataset.phase);
    return;
  }

  // Complete study
  const completeBtn = e.target.closest('[data-action="complete-study"]');
  if (completeBtn) {
    completeStudy();
    return;
  }

  // Review buttons
  const revealBtn = e.target.closest('[data-action="reveal"]');
  if (revealBtn) {
    revealAnswer();
    return;
  }

  const reviewNext = e.target.closest('[data-action="review-next"]');
  if (reviewNext) {
    nextReviewCard(reviewNext.dataset.knew === 'true');
    return;
  }

  const restartReview = e.target.closest('[data-action="restart-review"]');
  if (restartReview) {
    initReview();
    return;
  }

  // Toggle passage
  const togglePass = e.target.closest('#toggle-passage-btn');
  if (togglePass) {
    const txt = document.getElementById('study-passage-text');
    txt.classList.toggle('expanded');
    togglePass.textContent = txt.classList.contains('expanded') ? 'Show less' : 'Show more';
    return;
  }

  // Summary done
  const summaryDone = e.target.closest('#summary-done-btn');
  if (summaryDone) {
    showScreen('home');
    return;
  }
});


// ============================================================
// HOME SCREEN
// ============================================================

const passageRefInput = document.getElementById('passage-ref');
const passageTextInput = document.getElementById('passage-text');
const beginBtn = document.getElementById('begin-study-btn');

passageRefInput.addEventListener('input', function() {
  beginBtn.disabled = !passageRefInput.value.trim();
});

beginBtn.addEventListener('click', function(e) {
  e.preventDefault();
  const ref = passageRefInput.value.trim();
  const text = passageTextInput.value.trim();
  if (!ref) return;

  const study = {
    id: Date.now().toString(),
    ref,
    text,
    phase: 'observation',
    responses: {},
    createdAt: new Date().toISOString(),
    completedAt: null
  };

  state.studies.unshift(study);
  saveStudies();
  passageRefInput.value = '';
  passageTextInput.value = '';
  beginBtn.disabled = true;
  openStudy(study.id);
});

function renderHome() {
  const inProgress = state.studies.filter(s => !s.completedAt);
  const container = document.getElementById('recent-studies');
  const list = document.getElementById('recent-studies-list');

  if (inProgress.length === 0) {
    container.classList.add('hidden');
    return;
  }

  container.classList.remove('hidden');
  list.innerHTML = inProgress.slice(0, 5).map((s, i) => `
    <div class="study-card animate-fade-up" style="animation-delay: ${i * 0.04}s" data-action="open-study" data-study-id="${s.id}">
      <div class="study-card-left">
        <h3>${escapeHtml(s.ref)}</h3>
        <p>${formatDate(s.createdAt)}</p>
      </div>
      <span class="study-card-phase phase-${s.phase}">${s.phase}</span>
    </div>
  `).join('');
}


// ============================================================
// STUDY SCREEN
// ============================================================

function openStudy(id) {
  const study = state.studies.find(s => s.id === id);
  if (!study) return;

  // If completed, show summary view
  if (study.completedAt) {
    state.currentStudy = study;
    showSummary(study);
    return;
  }

  state.currentStudy = study;
  state.currentPhase = study.phase || 'observation';

  document.getElementById('study-passage-ref').textContent = study.ref;
  const passageTextEl = document.getElementById('study-passage-text');
  const toggleBtn = document.getElementById('toggle-passage-btn');

  if (study.text) {
    passageTextEl.textContent = study.text;
    passageTextEl.classList.remove('expanded');
    if (study.text.length > 200) {
      toggleBtn.classList.remove('hidden');
      toggleBtn.textContent = 'Show more';
    } else {
      toggleBtn.classList.add('hidden');
      passageTextEl.classList.add('expanded');
    }
  } else {
    passageTextEl.textContent = 'No passage text entered.';
    passageTextEl.style.fontStyle = 'italic';
    toggleBtn.classList.add('hidden');
  }

  renderPhase();
  showScreen('study');
  // Hide tab for study, show back
}

document.getElementById('study-back-btn').addEventListener('click', function(e) {
  e.preventDefault();
  saveCurrentResponses();
  showScreen('home');
});

function renderPhase() {
  const phase = state.currentPhase;
  const study = state.currentStudy;

  // Update tabs
  document.querySelectorAll('.phase-tab').forEach(t => {
    t.className = 'phase-tab';
    if (t.dataset.phase === phase) {
      t.classList.add(`active-${phase}`);
    }
  });

  // Render prompts
  const prompts = STUDY_PROMPTS[phase];
  const container = document.getElementById('prompts-container');

  container.innerHTML = prompts.map((p, i) => {
    const saved = study.responses[p.id] || '';
    return `
      <div class="prompt-card" style="animation-delay: ${i * 0.04}s">
        <div class="prompt-card-header">
          <h3>${p.title}</h3>
          <span class="book-ref">LBTB ${p.bookRef}</span>
        </div>
        <p>${p.description}</p>
        <textarea class="prompt-response" id="resp-${p.id}" placeholder="${p.placeholder}" data-prompt-id="${p.id}">${escapeHtml(saved)}</textarea>

```
  </div>
`;
```

}).join(â€™â€™);

// Auto-save on input
container.querySelectorAll(â€™.prompt-responseâ€™).forEach(ta => {
ta.addEventListener(â€˜inputâ€™, debounce(() => {
study.responses[ta.dataset.promptId] = ta.value;
saveStudies();
}, 500));

```
// Auto-resize
ta.addEventListener('input', function() {
  this.style.height = 'auto';
  this.style.height = Math.max(72, this.scrollHeight) + 'px';
});
```

});

// Phase navigation buttons
const navContainer = document.getElementById(â€˜phase-nav-btnsâ€™);
const phases = [â€˜observationâ€™, â€˜interpretationâ€™, â€˜applicationâ€™];
const idx = phases.indexOf(phase);

let btns = â€˜â€™;
if (idx > 0) {
btns += `<button class="phase-nav-btn secondary" data-action="go-phase" data-phase="${phases[idx-1]}">â† ${capitalize(phases[idx-1])}</button>`;
}
if (idx < phases.length - 1) {
btns += `<button class="phase-nav-btn primary" data-action="go-phase" data-phase="${phases[idx+1]}">${capitalize(phases[idx+1])} â†’</button>`;
}
if (idx === phases.length - 1) {
btns += `<button class="phase-nav-btn complete-btn" data-action="complete-study">Complete Study âœ“</button>`;
}
navContainer.innerHTML = btns;
}

function goPhase(phase) {
saveCurrentResponses();
state.currentPhase = phase;
state.currentStudy.phase = phase;
saveStudies();
renderPhase();
window.scrollTo({ top: 0, behavior: â€˜smoothâ€™ });
}

function saveCurrentResponses() {
if (!state.currentStudy) return;
document.querySelectorAll(â€™.prompt-responseâ€™).forEach(ta => {
state.currentStudy.responses[ta.dataset.promptId] = ta.value;
});
saveStudies();
}

function completeStudy() {
saveCurrentResponses();
state.currentStudy.completedAt = new Date().toISOString();
state.currentStudy.phase = â€˜completeâ€™;
saveStudies();
showSummary(state.currentStudy);
}

function showSummary(study) {
document.getElementById(â€˜summary-refâ€™).textContent = study.ref;

const phases = [
{ key: â€˜observationâ€™, label: â€˜Observationâ€™, cls: â€˜obsâ€™, prompts: STUDY_PROMPTS.observation },
{ key: â€˜interpretationâ€™, label: â€˜Interpretationâ€™, cls: â€˜intâ€™, prompts: STUDY_PROMPTS.interpretation },
{ key: â€˜applicationâ€™, label: â€˜Applicationâ€™, cls: â€˜appâ€™, prompts: STUDY_PROMPTS.application }
];

let html = â€˜â€™;
phases.forEach((phase, pi) => {
const entries = phase.prompts
.filter(p => study.responses[p.id] && study.responses[p.id].trim())
.map(p => `<div class="summary-entry animate-fade-up" style="animation-delay: ${pi * 0.08 + 0.05}s"> <h4>${p.title}</h4> <p>${escapeHtml(study.responses[p.id])}</p> </div>`).join(â€™â€™);

```
if (entries) {
  html += `
    <div class="summary-section animate-fade-up" style="animation-delay: ${pi * 0.08}s">
      <span class="summary-section-label ${phase.cls}">${phase.label}</span>
      ${entries}
    </div>
  `;
}
```

});

if (!html) {
html = â€˜<p style="text-align:center;color:var(--text-tertiary);padding:24px;">No notes recorded.</p>â€™;
}

document.getElementById(â€˜summary-contentâ€™).innerHTML = html;
showScreen(â€˜summaryâ€™);
}

// ============================================================
// REVIEW SCREEN
// ============================================================

function initReview() {
document.getElementById(â€˜streak-countâ€™).textContent = state.reviewedToday;

// Shuffle cards
state.reviewOrder = [â€¦Array(REVIEW_CARDS.length).keys()];
for (let i = state.reviewOrder.length - 1; i > 0; iâ€“) {
const j = Math.floor(Math.random() * (i + 1));
[state.reviewOrder[i], state.reviewOrder[j]] = [state.reviewOrder[j], state.reviewOrder[i]];
}
state.reviewIndex = 0;
state.reviewShowAnswer = false;
renderReviewCard();
}

function renderReviewCard() {
const container = document.getElementById(â€˜review-card-containerâ€™);
const btnsContainer = document.getElementById(â€˜review-btns-containerâ€™);
const progress = document.getElementById(â€˜review-progressâ€™);

if (state.reviewIndex >= state.reviewOrder.length) {
container.innerHTML = `<div class="review-card animate-scale-in"> <div class="question">You've been through all the cards! ğŸ‰</div> <p style="color:var(--text-secondary);margin-top:8px;">Tap below to shuffle and go again.</p> </div>`;
btnsContainer.innerHTML = `<button class="review-btn next" data-action="restart-review" style="width:100%">Shuffle & Restart</button>`;
progress.textContent = â€˜â€™;
return;
}

const card = REVIEW_CARDS[state.reviewOrder[state.reviewIndex]];
progress.textContent = `${state.reviewIndex + 1} of ${REVIEW_CARDS.length}`;

container.innerHTML = `<div class="review-card animate-scale-in"> <div class="question">${card.q}</div> <div class="book-ref">LBTB ${card.ref}</div> </div> ${state.reviewShowAnswer ?`
<div class="review-answer">
<p>${card.a}</p>
</div>
`: ''}`;

if (!state.reviewShowAnswer) {
btnsContainer.innerHTML = `<button class="review-btn reveal" data-action="reveal" style="width:100%">Reveal Answer</button>`;
} else {
btnsContainer.innerHTML = `<div class="review-btns"> <button class="review-btn didnt" data-action="review-next" data-knew="false">Didn't know</button> <button class="review-btn knew" data-action="review-next" data-knew="true">Knew it</button> </div>`;
}
}

function revealAnswer() {
state.reviewShowAnswer = true;
renderReviewCard();
}

function nextReviewCard(knew) {
state.reviewedToday++;
saveReviewCount();
document.getElementById(â€˜streak-countâ€™).textContent = state.reviewedToday;

if (!knew) {
// Put it back later in the deck
const current = state.reviewOrder[state.reviewIndex];
const insertAt = Math.min(state.reviewIndex + 3 + Math.floor(Math.random() * 3), state.reviewOrder.length);
state.reviewOrder.splice(insertAt, 0, current);
}

state.reviewIndex++;
state.reviewShowAnswer = false;
renderReviewCard();
}

// ============================================================
// HISTORY SCREEN
// ============================================================

function renderHistory() {
const list = document.getElementById(â€˜history-listâ€™);
const completed = state.studies.filter(s => s.completedAt);
const inProgress = state.studies.filter(s => !s.completedAt);
const all = [â€¦inProgress, â€¦completed];

if (all.length === 0) {
list.innerHTML = `<div class="empty-state"> <div class="icon">ğŸ“–</div> <p>No studies yet.<br>Start one from the Study tab.</p> </div>`;
return;
}

list.innerHTML = all.map((s, i) => {
const preview = getPreview(s);
return `<div class="history-card animate-fade-up" style="animation-delay: ${i * 0.03}s" data-action="open-history" data-study-id="${s.id}"> <div class="history-card-top"> <h3>${escapeHtml(s.ref)}</h3> <span class="study-card-phase phase-${s.completedAt ? 'complete' : s.phase}">${s.completedAt ? 'Complete' : capitalize(s.phase)}</span> </div> <div style="display:flex;justify-content:space-between;align-items:center;"> <span class="date">${formatDate(s.createdAt)}</span> <button class="delete-study-btn" data-action="delete-study" data-study-id="${s.id}">Delete</button> </div> ${preview ?`<p class="preview mt-8">${escapeHtml(preview)}</p>`: ''} </div>`;
}).join(â€™â€™);
}

function deleteStudy(id) {
if (!confirm(â€˜Delete this study?â€™)) return;
state.studies = state.studies.filter(s => s.id !== id);
saveStudies();
if (state.currentStudy && state.currentStudy.id === id) {
state.currentStudy = null;
}
renderHistory();
}

function getPreview(study) {
const keys = Object.keys(study.responses);
for (const k of keys) {
if (study.responses[k] && study.responses[k].trim()) {
return study.responses[k].trim().substring(0, 120);
}
}
return â€˜â€™;
}

// ============================================================
// UTILS
// ============================================================

function escapeHtml(str) {
if (!str) return â€˜â€™;
return str.replace(/&/g,â€™&â€™).replace(/</g,â€™<â€™).replace(/>/g,â€™>â€™).replace(/â€/g,â€™"â€™);
}

function capitalize(s) {
return s.charAt(0).toUpperCase() + s.slice(1);
}

function formatDate(iso) {
const d = new Date(iso);
const now = new Date();
const diff = now - d;
if (diff < 86400000) return â€˜Todayâ€™;
if (diff < 172800000) return â€˜Yesterdayâ€™;
return d.toLocaleDateString(â€˜en-USâ€™, { month: â€˜shortâ€™, day: â€˜numericâ€™ });
}

function debounce(fn, ms) {
let t;
return function(â€¦args) {
clearTimeout(t);
t = setTimeout(() => fn.apply(this, args), ms);
};
}

// ============================================================
// INIT
// ============================================================

loadState();
renderHome();
</script>

</body>
</html>